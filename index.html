
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Super Hara World - Blocos</title>
  <style>
    body { margin: 0; background: #111; color: white; text-align: center; font-family: sans-serif; }
    #menu, #gameContainer, #gameOver { display: none; }
    .btn { background: #444; color: white; border: none; padding: 15px 30px; font-size: 20px; border-radius: 10px; margin-top: 20px; }
    canvas { background: #87CEEB; border: 2px solid black; display: block; margin: 0 auto; }
    .hud { margin-top: 5px; font-size: 18px; }
  </style>
</head>
<body>

<div id="menu">
  <h1>Super Hara World</h1>
  <button class="btn" onclick="startGame()">JOGAR</button>
</div>

<div id="gameContainer">
  <canvas id="game" width="800" height="400"></canvas>
  <div class="hud">
    Pontuação: <span id="score">0</span>
  </div>
</div>

<audio id="coinSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_730d25e73e.mp3"></audio>
<audio id="blockBreak" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2dfb6dfc33.mp3"></audio>

<script>
const menu = document.getElementById('menu');
const gameContainer = document.getElementById('gameContainer');
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreDisplay = document.getElementById('score');
const coinSound = document.getElementById('coinSound');
const blockBreak = document.getElementById('blockBreak');

let score = 0;

const player = {
  x: 100, y: 300, width: 64, height: 64,
  dy: 0, vx: 0, onGround: false,
  jumpCount: 0, alive: true
};

const gravity = 0.8;
const jumpStrength = -14;
const speed = 4;
let keys = {};
let cameraX = 0;

const floor = { x: 0, y: 350, width: 3000, height: 50 };

const blocks = [
  { x: 400, y: 200, width: 40, height: 40, type: "surpresa", active: true },
  { x: 500, y: 200, width: 40, height: 40, type: "quebravel", active: true }
];

const img = new Image();
img.src = "sprite_personagem.png";

function startGame() {
  menu.style.display = "none";
  gameContainer.style.display = "block";
  loop();
}
menu.style.display = "block";

document.addEventListener('keydown', e => {
  keys[e.key] = true;
  if (e.key === " " && player.jumpCount < 2) {
    player.dy = jumpStrength;
    player.jumpCount++;
  }
});
document.addEventListener('keyup', e => keys[e.key] = false);

function update() {
  if (!player.alive) return;

  player.vx = 0;
  if (keys['ArrowRight']) player.vx = speed;
  if (keys['ArrowLeft']) player.vx = -speed;

  player.x += player.vx;
  player.dy += gravity;
  player.y += player.dy;
  player.onGround = false;

  if (player.y + player.height >= floor.y) {
    player.y = floor.y - player.height;
    player.dy = 0;
    player.onGround = true;
    player.jumpCount = 0;
  }

  for (const b of blocks) {
    if (!b.active) continue;

    // colisão superior (subir e bater em baixo do bloco)
    const headHit = player.y <= b.y + b.height &&
                    player.y + player.height > b.y + b.height &&
                    player.x + player.width > b.x &&
                    player.x < b.x + b.width &&
                    player.dy < 0;

    if (headHit) {
      if (b.type === "surpresa") {
        coinSound.currentTime = 0;
        coinSound.play();
        b.active = false;
        score += 100;
        scoreDisplay.textContent = score;
      } else if (b.type === "quebravel") {
        blockBreak.currentTime = 0;
        blockBreak.play();
        b.active = false;
      }
      player.dy = 1; // forçar queda
    }
  }

  if (player.x < 0) player.x = 0;
  if (player.x + player.width > floor.width) player.x = floor.width - player.width;

  cameraX = player.x - canvas.width / 2;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.save();
  ctx.translate(-cameraX, 0);

  ctx.fillStyle = "green";
  ctx.fillRect(floor.x, floor.y, floor.width, floor.height);

  for (const b of blocks) {
    if (!b.active) continue;
    if (b.type === "surpresa") ctx.fillStyle = "orange";
    else ctx.fillStyle = "brown";
    ctx.fillRect(b.x, b.y, b.width, b.height);
  }

  ctx.drawImage(img, player.x, player.y, player.width, player.height);
  ctx.restore();
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
</script>
</body>
</html>
